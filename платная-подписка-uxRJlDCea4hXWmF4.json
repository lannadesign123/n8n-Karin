{"createdAt":"2025-06-19T10:53:11.083Z","updatedAt":"2025-06-19T10:54:33.958Z","id":"uxRJlDCea4hXWmF4","name":"–ü–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-120,-100],"id":"5bf7c6e2-ae22-4710-b84b-0f86c228cce8","name":"–ø–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞"},{"parameters":{"chatId":"={{ $json.chat_id }}","text":"={{ $json.text }}","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"‚úÖ–û—Ç–ª–∏—á–Ω–æ","additionalFields":{"callback_data":"={{ $('Code').item.json.reply_markup.inline_keyboard[0][0].callback_data }}"}},{"text":"üîÅ –ò–∑–º–µ–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä","additionalFields":{"callback_data":"={{ $('Code').item.json.reply_markup.inline_keyboard[0][1].callback_data }}"}}]}}]},"additionalFields":{}},"name":"Send Products to Telegram","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1060,-100],"id":"08fa3b82-d28c-4ac4-9539-df17fa52e413","webhookId":"1aa4a16e-2b28-417a-be38-5b785433341e","credentials":{"telegramApi":{"id":"6WZbRqNGvR0VEngG","name":"Telegram account"}}},{"parameters":{"jsCode":"const chatId = $json.chat_id || 1147618121;\nconst messageId = $json.message_id || 0;\nconst typeSkin = $json.type_skin || \"–∂–∏—Ä–Ω–∞—è\";\nconst budget = $('Edit Fields3').first().json.budget || \"–Ω–µ —É–∫–∞–∑–∞–Ω\";\n\nlet raw = $json.output || \"\";\n\n// –§–æ—Ä–º–∏—Ä—É–µ–º –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç\nlet text = `‚ú® –í–æ—Ç –ø–æ–¥–±–æ—Ä–∫–∞ —Å –±—é–¥–∂–µ—Ç–æ–º *${budget}*:\\n\\n`;\ntext += `–õ—É—á—à–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è —É—Ö–æ–¥–∞ –∑–∞ –∫–æ–∂–µ–π –ª–∏—Ü–∞, –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–æ–¥ –≤–∞—à —Ç–∏–ø –∫–æ–∂–∏ –∏ –±—é–¥–∂–µ—Ç:\\n\\n`;\ntext += `‚¨áÔ∏è –í–æ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç–æ–≤–∞—Ä—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–∏–º –±—é–¥–∂–µ—Ç–æ–º –∏ —Ç–∏–ø–æ–º –∫–æ–∂–∏:\\n\\n`;\n\n// –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –æ—Ç Firecrawl –Ω–∞–ø—Ä—è–º—É—é\ntext += raw.trim();\n\n// –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å —Å –∫–Ω–æ–ø–∫–∞–º–∏\ntext += `\\n\\n_–í–∞—Å –≤—Å—ë —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç?_`;\n\nreturn {\n  json: {\n    chat_id: chatId,\n    message_id: messageId,\n    budget,\n    type_skin: typeSkin,\n    text,\n    reply_markup: {\n      inline_keyboard: [\n        [\n          { text: \"‚úÖ –û—Ç–ª–∏—á–Ω–æ\", callback_data: \"products_yes\" },\n          { text: \"üîÅ –ó–∞–º–µ–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä\", callback_data: \"products_change\" }\n        ]\n      ]\n    }\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[760,-100],"id":"c8babc10-499c-49ed-90f1-5779eb86410f","name":"Code"},{"parameters":{"promptType":"define","text":"=\n","options":{"systemMessage":"=You are a **DERMATOLOGIST AND COSMETOLOGIST**, an expert in skincare and cosmetic formulations.\nYour task is to recommend skincare products based on the user's skin type and their budget.\n\nBudget: **{{ $json.budget }}**\nSkin Type: **{{ $json.type_skin }}**\n\n‚úÖ Use the online store https://aravia.ru/ to help identify suitable products.\n\n‚ö†Ô∏è **Always respond in Russian language**.  \n‚ö†Ô∏è **Format your response for Telegram in Markdown**.\n\nYour response should:\n\nüîπ Select up to 7 products that match the skin type and fit within the specified budget. Use real product links from the internet (preferably from https://aravia.ru/). Search for products for face only.\n\nüîπ Distribute them into the following categories, in this order, if applicable:\n1. üåü–¢–æ–Ω–µ—Ä  \n2. üíß–°—ã–≤–æ—Ä–æ—Ç–∫–∞  \n3. üåû–ö—Ä–µ–º –¥–Ω–µ–≤–Ω–æ–π  \n4. üåô–ö—Ä–µ–º –Ω–æ—á–Ω–æ–π  \n5. üëÅÔ∏è–ö—Ä–µ–º –¥–ª—è –≥–ª–∞–∑  \n6. ‚òÄÔ∏èSPF  \n7. ‚ú®–ü–∏–ª–∏–Ω–≥ / —Å–∫—Ä–∞–±\n\n–Ω–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç:\n{{ $json.markdown }}\n\nEach product must include:\n- –ù–∞–∑–≤–∞–Ω–∏–µ (Name)\n- –ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (Short description)\n- –¶–µ–Ω–∞ (Price)\n- –†–µ–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä (Real product link)\n\n–°alculate the total cost of goods  \nExample:  \n–û–±—â–∏–π –±—é–¥–∂–µ—Ç: –ø—Ä–∏–º–µ—Ä–Ω–æ 4,580 ‚ÇΩ, —á—Ç–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –≤–∞—à –ª–∏–º–∏—Ç 5000 ‚ÇΩ.\n\nReturn the final result as a beautifully formatted Markdown list in Russian.\n\n\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2,"position":[360,-100],"id":"79fd7280-96db-4d61-a83a-4c3fe96576f7","name":"Search Agent"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1-nano","mode":"list","cachedResultName":"gpt-4.1-nano"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[220,140],"id":"b2af3ac2-256a-4875-9e7a-6e086bbe11af","name":"OpenAI Chat Model2","credentials":{"openAiApi":{"id":"N0DXVxFFyshgrkn2","name":"OpenAi account"}}},{"parameters":{"toolDescription":"Use this tool to search the https://aravia.ru/","method":"POST","url":"https://api.firecrawl.dev/v1/scrape","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer fc-4a429c6f884e4b9a9eae1e7c8fdeaaac"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"url\": \"https://aravia.ru/\",\n  \"formats\": [\n    \"markdown\",\n    \"html\"\n  ]\n}","options":{}},"type":"n8n-nodes-base.httpRequestTool","typeVersion":4.2,"position":[760,240],"id":"c9010b16-8b05-4230-891f-42f3c32a7f10","name":"Firecrawl Search","credentials":{"httpHeaderAuth":{"id":"qviB60gv9EbG3cfx","name":"Header Auth account"}}}],"connections":{"Code":{"main":[[{"node":"Send Products to Telegram","type":"main","index":0}]]},"Search Agent":{"main":[[{"node":"Code","type":"main","index":0}]]},"OpenAI Chat Model2":{"ai_languageModel":[[{"node":"Search Agent","type":"ai_languageModel","index":0}]]},"Firecrawl Search":{"ai_tool":[[{"node":"Search Agent","type":"ai_tool","index":0}]]},"–ø–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞":{"main":[[{"node":"Search Agent","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"4e7538e4-96db-4942-82ea-fcb263c87583","triggerCount":0,"tags":[]}